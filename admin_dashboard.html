<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Chai ThePeople</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="admin_style.css">
</head>
<body>

    <header>
        <h1>Chai ThePeople - Admin Panel</h1>
        <nav>
             <ul>
                <li><a href="index.html">Home</a></li>
                <li id="nav-login" style="display: none;"><a href="login.html">Login</a></li>
                <li id="nav-register" style="display: none;"><a href="register.html">Register</a></li>
                <li id="nav-admin-dash" style="display: inline;"><a href="#">Admin Dashboard</a></li>
                <li id="nav-dashboard" style="display: none;"><a href="user_dashboard.html">User Dashboard</a></li>
                <li id="nav-shop-dash" style="display: none;"><a href="shop_dashboard.html">Shop Dashboard</a></li>
                <li id="nav-logout" style="display: none;">
                    <a href="#" id="logout-button">Logout</a>
                </li>
                 <li id="user-greeting" style="display: none; margin-left: 15px; color: #ffcc99;"></li>
            </ul>
        </nav>
    </header>

    <main class="admin-container">
        <h2>Admin Dashboard</h2>

        <!-- Section to Add/Edit Questions -->
        <section id="add-question-section">
            <h3>Add New Survey Question</h3>
            <form id="add-question-form">
                <div class="form-group">
                    <label for="new-question-text">Question Text:</label>
                    <textarea id="new-question-text" name="questionText" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label for="new-question-options">Answer Options (one per line):</label>
                    <textarea id="new-question-options" name="questionOptions" rows="5" placeholder="Daily
Few times a week
Occasionally" required></textarea>
                </div>
                <!-- NEW: Scope Selection -->
                <div class="form-group">
                    <label>Scope:</label>
                    <label><input type="radio" name="scope" value="global" checked> Global (All Stalls)</label>
                    <label><input type="radio" name="scope" value="specific"> Specific Stalls</label>
                </div>
                <!-- NEW: Target Stalls (Hidden by default) -->
                <div class="form-group" id="target-stalls-group" style="display: none;">
                    <label for="new-question-target-select">Target Stalls:</label>
                    <!-- Replace input with select multiple -->
                    <select multiple id="new-question-target-select" name="questionTargets" size="5">
                        <!-- Options will be populated by JavaScript -->
                        <option value="" disabled>Loading stalls...</option>
                    </select>
                    <small>Hold Ctrl (or Cmd on Mac) to select multiple stalls.</small>
                    <small id="no-stalls-message" style="display: none; color: orange;"> No stalls found in the database. Add stalls first.</small>
               </div>
                <button type="submit" class="form-button">Add Question</button>
                <p id="add-question-status" class="status-message"></p>
            </form>
        </section>

        <!-- Section to Manage Existing Questions -->
        <section id="manage-questions-section">
            <h3>Existing Questions</h3>
            <div id="existing-questions-list">
                <p id="loading-existing-questions">Loading questions...</p>
                <!-- Questions will be loaded here -->
            </div>
             <p id="no-existing-questions" style="display: none;">No questions found.</p>
        </section>

        <!-- NEW: Section to Manage Users -->
        <section id="manage-users-section">
            <h3>Manage Users</h3>
             <div id="user-list-controls">
                 <!-- Maybe add filters later (by role, search) -->
             </div>
            <div id="user-list-container">
                 <p id="loading-users">Loading users...</p>
                 <table id="user-table" style="width: 100%; display: none;">
                     <thead>
                         <tr>
                             <th>Name</th>
                             <th>Email</th>
                             <th>Role</th>
                             <th>Actions</th>
                         </tr>
                     </thead>
                     <tbody id="user-table-body">
                         <!-- User rows will be loaded here -->
                     </tbody>
                 </table>
                 <p id="no-users-found" style="display: none;">No users found.</p>
            </div>
            <p id="user-action-status" class="status-message"></p>
        </section>

        <!-- NEW: Section for Survey Results -->
        <section id="survey-results-section">
            <h3>Survey Results Overview</h3>
            <div id="results-container">
                 <p id="loading-results">Loading results...</p>
                 <!-- Results will be loaded here -->
            </div>
            <p id="no-results-found" style="display: none;">No survey responses found yet.</p>
        </section>

    </main>

    <footer>
        <p>Â© 2024 Chai ThePeople. Making a difference, together.</p>
    </footer>

    <script type="module" src="auth.js"></script>
    <script type="module" src="admin.js"></script>

</body>
</html>